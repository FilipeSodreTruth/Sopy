<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Parallax Vertical com Cobertura</title>

  <!-- Cole o CSS abaixo no seu styles.css ou deixe aqui dentro de <style> -->
  <style>
    :root {
      --bg-color: #1a1a1a;
      --text-color: #f0f0f0;
      --muted-color: #a0a0a0;
      --spacing: clamp(1.5rem, 5vw, 4rem);
      --radius: 16px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, sans-serif;
      color: var(--text-color);
      background-color: var(--bg-color);
      scrollbar-width: none;
    }
    body::-webkit-scrollbar { display: none; }

    /* --- Container principal da história de scroll --- */
    .scroll-container.sustainability-parallax {
      position: relative;
      width: 100%;
      /* a altura é definida via JS: (n painéis) * 100vh */
    }

    /* --- Cada painel ocupa 100vh e fica sticky --- */
    .scroll-container.sustainability-parallax .fullscreen-panel {
      position: sticky;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      background-color: var(--bg-color);
    }

    /* --- Layout 2 colunas alternável por data-layout --- */
    .scroll-container.sustainability-parallax .panel-content {
      display: flex;
      height: 100%;
      width: 100%;
      padding: var(--spacing);
      gap: var(--spacing);
      align-items: center;
    }
    .scroll-container.sustainability-parallax
    .fullscreen-panel[data-layout="right-image"] .panel-content {
      flex-direction: row-reverse;
    }

    .scroll-container.sustainability-parallax .image-column,
    .scroll-container.sustainability-parallax .text-column {
      flex: 1;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    /* --- Imagem: retângulo vertical 3 / 4.5 --- */
    .scroll-container.sustainability-parallax .image-wrapper {
      width: clamp(280px, 45vw, 480px);
      margin: 0 auto;
      aspect-ratio: 3 / 4.5;
      overflow: hidden;
      border-radius: var(--radius);
      transform-origin: center center; /* para o scale() */
    }
    .scroll-container.sustainability-parallax .image-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Tipografia --- */
    .scroll-container.sustainability-parallax .text-column h2 {
      font-size: clamp(2.5rem, 6vw, 4.5rem);
      line-height: 1.1;
      margin-bottom: 1.5rem;
      color: var(--text-color);
    }
    .scroll-container.sustainability-parallax .text-column p {
      font-size: 1.1rem;
      line-height: 1.7;
      color: var(--muted-color);
      max-width: 55ch;
    }

    /* --- Intro opcional --- */
    .scroll-container.sustainability-parallax .intro-panel {
      display: grid;
      place-items: center;
      text-align: center;
    }
    .scroll-container.sustainability-parallax .intro-panel h1 {
      font-size: 3rem;
      margin-bottom: 0.5rem;
      color: var(--text-color);
    }
    .scroll-container.sustainability-parallax .intro-panel p {
      font-size: 1.2rem;
      color: var(--muted-color);
    }

    /* --- Responsivo --- */
    @media (max-width: 900px) {
      .scroll-container.sustainability-parallax .panel-content {
        flex-direction: column !important;
        text-align: center;
        justify-content: center;
        gap: 2rem;
      }
      .scroll-container.sustainability-parallax .text-column h2 {
        font-size: clamp(2rem, 8vw, 3rem);
      }
      .scroll-container.sustainability-parallax .image-wrapper {
        width: min(320px, 80vw);
        aspect-ratio: 3 / 4.5; /* mantém o vertical também no mobile */
      }
    }
  </style>
</head>
<body>

  <!-- Se já existe um <main> no seu projeto, troque por <div id="sustentabilidade" class="scroll-container sustainability-parallax"> -->
  <main id="sustentabilidade" class="scroll-container sustainability-parallax">
    <section class="fullscreen-panel intro-panel">
      <div>
        <h1>Animação de Scroll</h1>
        <p>Uma narrativa com efeito de cobertura e parallax<br>usando imagens verticais.</p>
      </div>
    </section>

    <section class="fullscreen-panel" data-layout="left-image">
      <div class="panel-content">
        <div class="image-column">
          <div class="image-wrapper">
            <img src="https://images.unsplash.com/photo-1542189793-018819c1a71d?q=80&w=1974&auto=format&fit=crop" alt="Escadaria em espiral vista de baixo, com arquitetura moderna.">
          </div>
        </div>
        <div class="text-column">
          <h2>Seção Um</h2>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation.</p>
        </div>
      </div>
    </section>

    <section class="fullscreen-panel" data-layout="right-image">
      <div class="panel-content">
        <div class="image-column">
          <div class="image-wrapper">
            <img src="https://images.unsplash.com/photo-1448375240586-882707db888b?q=80&w=2070&auto=format&fit=crop" alt="Pessoa em uma floresta com raios de sol passando pelas árvores.">
          </div>
        </div>
        <div class="text-column">
          <h2>Seção Dois</h2>
          <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit.</p>
        </div>
      </div>
    </section>

    <section class="fullscreen-panel" data-layout="left-image">
      <div class="panel-content">
        <div class="image-column">
          <div class="image-wrapper">
            <img src="https://images.unsplash.com/photo-1558591710-4b4a1ae0f04d?q=80&w=1974&auto=format&fit=crop" alt="Textura abstrata de mármore branco e dourado com efeito líquido.">
          </div>
        </div>
        <div class="text-column">
          <h2>Seção Três</h2>
          <p>Ullamco laboris nisi ut aliquip ex ea commodo consequat. Animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et expedita distinctio.</p>
        </div>
      </div>
    </section>

    <section class="fullscreen-panel" data-layout="right-image">
      <div class="panel-content">
        <div class="image-column">
          <div class="image-wrapper">
            <img src="https://images.unsplash.com/photo-1506784983877-45594efa4cbe?q=80&w=2068&auto=format&fit=crop" alt="Pessoa escrevendo em um planejador com uma vista da cidade ao fundo.">
          </div>
        </div>
        <div class="text-column">
          <h2>Seção Quatro</h2>
          <p>Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est.</p>
        </div>
      </div>
    </section>
  </main>

  <!-- Cole o JS abaixo no seu main.js ou aqui dentro de <script> -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // ----- CORREÇÃO APLICADA AQUI -----
      // As variáveis 'panels' e 'scrollContainer' precisam ser definidas ANTES de serem usadas.
      const panels = Array.from(document.querySelectorAll('.fullscreen-panel'));
      const scrollContainer = document.querySelector('.scroll-container');
      const vh = window.innerHeight;

      // A função agora usa a variável 'scrollContainer' corretamente
      function setContainerHeight() {
        scrollContainer.style.height = `${panels.length * 100}vh`; // Removido o '\'
      }
      
      setContainerHeight();
      // ------------------------------------
      
      const ZOOM_AMOUNT = 0.15;
      const BORDER_RADIUS_AMOUNT = 50;

      let ticking = false;

      function updateAnimation() {
        const scrollY = window.scrollY;
        
        const currentPanelIndex = Math.floor(scrollY / vh);
        const progress = (scrollY % vh) / vh;

        panels.forEach((panel, i) => {
          const imageWrapper = panel.querySelector('.image-wrapper');
          if (!imageWrapper) return;

          if (i === currentPanelIndex) {
            const scale = 1 - (progress * ZOOM_AMOUNT);
            const borderRadius = 16 + (progress * BORDER_RADIUS_AMOUNT);
            
            imageWrapper.style.transform = `scale(${scale})`;
            imageWrapper.style.borderRadius = `${borderRadius}px`;
          } 
          else if (i < currentPanelIndex) {
            const finalScale = 1 - ZOOM_AMOUNT;
            const finalBorderRadius = 16 + BORDER_RADIUS_AMOUNT;
            imageWrapper.style.transform = `scale(${finalScale})`;
            imageWrapper.style.borderRadius = `${finalBorderRadius}px`;
          } 
          else {
            imageWrapper.style.transform = 'scale(1)';
            imageWrapper.style.borderRadius = '16px';
          }
        });
        
        ticking = false;
      }

      function onScroll() {
        if (!ticking) {
          window.requestAnimationFrame(() => {
            updateAnimation();
          });
          ticking = true;
        }
      }

      window.addEventListener('scroll', onScroll);
      updateAnimation();
    });
  </script>
</body>
</html>